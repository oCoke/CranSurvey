import{l as T,u as S,n as _,r as s,o as r,c as d,a as l,t as o,b as n,w as t,F as v,f as N,g as f,s as h,i as y,d as k}from"./entry.dc320ebb.js";/* empty css             */const P={class:"text-h4"},D={class:"mainGroup"},L=["textContent"],V={class:"text-subtitle-1"},A={key:0},F=T(),j={position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!1,draggablePercent:.6,showCloseButtonOnHover:!0,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1},H={data(){return{drawer:!0,rail:!0,siteUsersLoading:!0,siteUsersData:"",siteUsers:[],siteAdmins:[],loading:!0}},methods:{signout(){sessionStorage.removeItem("_cransurvey_token"),sessionStorage.removeItem("_cransurvey_usr"),F.success(this.$t("users.signout_success"),j),_(S()("/sign-in"))}},async mounted(){const a=await $fetch("/api/dash/users",{method:"POST",body:JSON.stringify({token:sessionStorage.getItem("_cransurvey_token")})});let i=0;this.siteAdmins=a.admins;for(const e in a.list)i++,this.siteUsers.push({title:a.list[e],uid:i});a.code==0?this.siteUsersData=this.$t("dashboard.site_users",a.count):this.siteUsersData=this.$t("dashboard.error_fetching_data"),this.siteUsersLoading=!1,this.username=sessionStorage.getItem("_cransurvey_usr"),this.loading=!1}},G=Object.assign(H,{__name:"index",setup(a){const i=S();{const e=sessionStorage.getItem("_cransurvey_token"),m=sessionStorage.getItem("_cransurvey_usr");!e||!m?_(i("/sign-in")):sessionStorage.getItem("_cransurvey_token_lock")||$fetch("/api/usr/token",{method:"POST",body:JSON.stringify({token:e})}).then(u=>{u.code==0?sessionStorage.setItem("_cransurvey_token_lock",!0):(sessionStorage.removeItem("_cransurvey_token"),sessionStorage.removeItem("_cransurvey_usr"),_(i("/sign-in")))})}return(e,m)=>{const u=s("v-col"),b=s("v-fade-transition"),x=s("v-row"),C=s("v-expansion-panel-title"),I=s("v-spacer"),p=s("v-btn"),U=s("v-card-actions"),$=s("v-expansion-panel-text"),O=s("v-expansion-panel"),w=s("v-expansion-panels"),B=s("v-card");return r(),d(v,null,[l("h1",P,o(e.$t("users.users")),1),l("div",D,[l("code",{class:"text-subtitle-1",style:{"font-family":"monospace !important"},textContent:o(e.$t("users.signed",{username:"`"+e.username+"`"}))},null,8,L),l("p",V,o(e.siteUsersData),1),n(B,{variant:"flat",style:{margin:"20px auto",padding:"15px"},loading:e.loading},{default:t(()=>[n(w,null,{default:t(()=>[(r(!0),d(v,null,N(e.siteUsers,c=>(r(),f(O,null,{default:t(()=>[n(C,null,{default:t(({expanded:g})=>[n(x,{"no-gutters":""},{default:t(()=>[n(u,{cols:"4",class:"d-flex justify-start"},{default:t(()=>[l("code",null,o(c.title),1)]),_:2},1024),n(u,{cols:"8",class:"text-grey"},{default:t(()=>[n(b,{"leave-absolute":""},{default:t(()=>[g?(r(),d("span",A," #"+o(c.uid),1)):h("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),n($,null,{default:t(()=>[n(U,null,{default:t(()=>[n(I),c.title==e.username||e.siteAdmins.includes(e.username)?(r(),f(p,{key:0,variant:"text",color:"primary",onClick:g=>("navigateTo"in e?e.navigateTo:y(_))(y(i)("/dash/users/edit?username="+c.title))},{default:t(()=>[k(o(e.$t("edit.edit")),1)]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1},8,["loading"]),n(p,{variant:"outlined",onClick:e.signout},{default:t(()=>[k(o(e.$t("users.signout")),1)]),_:1},8,["onClick"])])],64)}}});export{G as default};
