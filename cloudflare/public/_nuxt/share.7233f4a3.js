import{z as C,u as w,n as c,r as l,o as k,c as v,a as _,t as i,b as t,w as o,d as g,q as f,v as y,s as V,F as S,l as q}from"./entry.dc320ebb.js";/* empty css             */const I={class:"text-h4"},L={class:"mainGroup"},T={class:"card-group"},P={class:"card-side-group"},B=["src"],b=q(),$={position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!1,draggablePercent:.6,showCloseButtonOnHover:!0,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1},O={data(){return{drawer:!0,rail:!0,qrcode_html:"",page_link:"",page_shorten_link:"",shorten_link_expire:0,shortened_link_generate:!1}},methods:{generateQRCode(){this.qrcode_html=`<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(this.page_link)}">`},copyPageLink(){navigator.clipboard.writeText(this.page_link),b.success(this.$t("share.copied"),$)},copyShortenLink(){navigator.clipboard.writeText(this.page_shorten_link),b.success(this.$t("share.copied"),$)}},async mounted(){const m=location.host;this.page_link="http://"+m+"/view/"+this.$route.query.id,window.onmessage=a=>{a.data&&a.data.status&&a.data.status==200&&(this.page_shorten_link="https://proj.sbs/"+a.data.url)}}},H=C({...O,__name:"share",setup(m){const a=w();{const e=sessionStorage.getItem("_cransurvey_token"),n=sessionStorage.getItem("_cransurvey_usr");!e||!n?c(a("/sign-in")):sessionStorage.getItem("_cransurvey_token_lock")||$fetch("/api/usr/token",{method:"POST",body:JSON.stringify({token:e})}).then(r=>{r.code==0?sessionStorage.setItem("_cransurvey_token_lock",!0):(sessionStorage.removeItem("_cransurvey_token"),sessionStorage.removeItem("_cransurvey_usr"),c(a("/sign-in")))})}return(e,n)=>{const r=l("v-text-field"),d=l("v-card-text"),u=l("v-btn"),h=l("v-card-actions"),p=l("v-card");return k(),v(S,null,[_("h1",I,i(e.$t("share.share")),1),_("div",L,[_("div",T,[_("div",P,[t(p,{title:e.$t("share.link"),variant:"outlined"},{default:o(()=>[t(d,{style:{"padding-bottom":"0"}},{default:o(()=>[t(r,{label:e.$t("share.link"),variant:"outlined",modelValue:e.page_link,"onUpdate:modelValue":n[0]||(n[0]=s=>e.page_link=s),ref:"pagelink"},null,8,["label","modelValue"])]),_:1}),t(h,{style:{"padding-top":"0"}},{default:o(()=>[t(u,{onClick:n[1]||(n[1]=s=>e.copyPageLink())},{default:o(()=>[g(i(e.$t("share.copy")),1)]),_:1})]),_:1})]),_:1},8,["title"]),t(p,{title:e.$t("share.shorten_link"),variant:"outlined",style:{"margin-top":"20px"}},{default:o(()=>[f(t(d,{style:{"padding-bottom":"0"}},{default:o(()=>[t(r,{label:e.$t("share.shortener_link"),variant:"outlined",modelValue:e.page_shorten_link,"onUpdate:modelValue":n[2]||(n[2]=s=>e.page_shorten_link=s),disabled:""},null,8,["label","modelValue"]),t(r,{label:e.$t("share.valid_times"),variant:"outlined",modelValue:e.shorten_link_expire,"onUpdate:modelValue":n[3]||(n[3]=s=>e.shorten_link_expire=s),type:"number"},null,8,["label","modelValue"]),e.page_shorten_link?V("",!0):(k(),v("iframe",{key:0,src:"https://t.cky.im/widget.html?expire="+e.shorten_link_expire+"&pid=&url="+encodeURIComponent(e.page_link),frameborder:"0",style:{width:"100%"}},null,8,B))]),_:1},512),[[y,e.shortened_link_generate]]),t(h,{style:{"padding-top":"0"}},{default:o(()=>[f(t(u,{onClick:n[4]||(n[4]=s=>e.shortened_link_generate=!0)},{default:o(()=>[g(i(e.$t("share.generate")),1)]),_:1},512),[[y,!e.shortened_link_generate]]),t(u,{onClick:n[5]||(n[5]=s=>e.copyShortenLink())},{default:o(()=>[g(i(e.$t("share.copy")),1)]),_:1})]),_:1})]),_:1},8,["title"])]),t(p,{title:e.$t("share.qrcode"),variant:"outlined"},{default:o(()=>[t(d,{class:"qrcode_box"},{default:o(()=>[t(p,{class:"qrcode_img",variant:"tonal"},{default:o(()=>[t(d,{innerHTML:e.qrcode_html,style:{padding:"0"}},null,8,["innerHTML"])]),_:1})]),_:1}),t(h,null,{default:o(()=>[t(u,{onClick:n[6]||(n[6]=s=>e.generateQRCode())},{default:o(()=>[g(i(e.$t("share.generate")),1)]),_:1})]),_:1})]),_:1},8,["title"])])])],64)}}});export{H as default};
