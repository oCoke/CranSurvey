import{u as m,n,r as g,o as f,c as y,a as h,t as u,b as a,w as o,i as d,d as _,F as S,j as k,k as b}from"./entry.d0f737aa.js";/* empty css             */const p={class:"text-h4"},$={class:"card-group"},D={data(){return{drawer:!0,rail:!0,ongoingLoading:!0,ongoingSurveysData:"",lang:k().locale.value,siteUsersLoading:!0,siteUsersData:""}},methods:{switchLang(){n(b()(this.lang))}},async mounted(){const r=await $fetch("/api/dash/ongoing",{method:"POST",body:JSON.stringify({token:sessionStorage.getItem("_cransurvey_token")})});r.code==0?this.ongoingSurveysData=this.$t("dashboard.ongoing_surveys",r.count):this.ongoingSurveysData=this.$t("dashboard.error_fetching_data")+" ("+this.$t("error_codes."+r.code)+")",this.ongoingLoading=!1;const t=await $fetch("/api/dash/users",{method:"POST",body:JSON.stringify({token:sessionStorage.getItem("_cransurvey_token")})});t.code==0?this.siteUsersData=this.$t("dashboard.site_users",t.count):this.siteUsersData=this.$t("dashboard.error_fetching_data")+" ("+this.$t("error_codes."+t.code)+")",this.siteUsersLoading=!1}},T=Object.assign(D,{__name:"index",setup(r){const t=m();{const e=sessionStorage.getItem("_cransurvey_token"),s=sessionStorage.getItem("_cransurvey_usr");!e||!s?n(t("/sign-in")):sessionStorage.getItem("_cransurvey_token_lock")||$fetch("/api/usr/token",{method:"POST",body:JSON.stringify({token:e})}).then(i=>{i.code==0?sessionStorage.setItem("_cransurvey_token_lock",!0):(sessionStorage.removeItem("_cransurvey_token"),sessionStorage.removeItem("_cransurvey_usr"),n(t("/sign-in")))})}return(e,s)=>{const i=g("v-btn"),l=g("v-card-actions"),c=g("v-card");return f(),y(S,null,[h("h1",p,u(e.$t("dashboard.dashboard")),1),h("div",$,[a(c,{title:e.$t("dashboard.surveys"),text:e.ongoingSurveysData,loading:e.ongoingLoading,variant:"outlined"},{default:o(()=>[a(l,null,{default:o(()=>[a(i,{onClick:s[0]||(s[0]=v=>("navigateTo"in e?e.navigateTo:d(n))(d(t)("/dash/surveys")))},{default:o(()=>[_(u(e.$t("dashboard.manage")),1)]),_:1})]),_:1})]),_:1},8,["title","text","loading"]),a(c,{title:e.$t("dashboard.users"),text:e.siteUsersData,loading:e.siteUsersLoading,variant:"outlined"},{default:o(()=>[a(l,null,{default:o(()=>[a(i,{onClick:s[1]||(s[1]=v=>("navigateTo"in e?e.navigateTo:d(n))(d(t)("/dash/users")))},{default:o(()=>[_(u(e.$t("dashboard.manage")),1)]),_:1})]),_:1})]),_:1},8,["title","text","loading"])])],64)}}});export{T as default};
