import{u as ne}from"./vue.f36acd1f.e1a654df.js";import{z as se,l as ae,h as E,A as P,r as p,o as _,c as v,a as y,b as i,w as u,d as w,t as f,i as h,F as $,f as j,q as x,v as k,g as B,s as m,m as le,p as ie,e as re}from"./entry.d0f737aa.js";import{_ as de}from"./_plugin-vue_export-helper.c27b6911.js";const ue=e=>Object.fromEntries(Object.entries(e).filter(([,o])=>o!==void 0)),pe=(e,o)=>(s,a)=>(ne(()=>e({...ue(s),...a.attrs},a)),()=>{var l,g;return o?(g=(l=a.slots).default)==null?void 0:g.call(l):null}),ce=se({name:"Title",inheritAttrs:!1,setup:pe((e,{slots:o})=>{var s,a,l;return{title:((l=(a=(s=o.default)==null?void 0:s.call(o))==null?void 0:a[0])==null?void 0:l.children)||null}})});function T(e,o,s){if(o=="short_answer"){if(s.includes(":"))return e.length>=parseInt(s.split(":")[0])&&e.length<=parseInt(s.split(":")[1])}else if(o=="paragraph"){if(s.includes(":"))return e.length>=parseInt(s.split(":")[0])&&e.length<=parseInt(s.split(":")[1])}else if(o=="info"){if(s=="disabled"&&e)return!1;if(!s)return!1}else{if(o=="multiple"||o=="dropdown")return!(typeof e!="number"||e>=s);if(o=="checkboxes"){if(e.length>s)return!1;for(const a in e)if(e[a]!==!1&&e[a]!==!0)return!1;return!0}else{if(o=="date")return typeof e!="number"?!1:e>=s[0]&&e<=s[1];if(o=="file"){const a=new URL(e);if(a.hostname=="transfer.sh"&&e.length<=2048){const l={images:["png","jpg","jpeg","gif","webp","svg","ico","bmp","tiff","tif"],docs:["docs","doc","docx","odt","rtf","tex","txt","wpd"],pdf:["pdf"],sheets:["sheets","xls","xlsx","ods","csv"],slides:["slides","ppt","pptx","odp"],audios:["mp3","wav","wma","m4a","aac","oga","flac","webma"],videos:["mp4","webm","mov","mkv","flv","ogv","avi","wmv","m4v"],archives:["zip","tar.gz","tar.xz","tar.lz","tar.bz2","tar"]};if(s.length==0)return!0;for(const g in s)if(l[s[g]].includes(a.pathname.split(".").pop()))return!0}else return!1}else return!1}}}let S;const _e=new Uint8Array(16);function fe(){if(!S&&(S=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!S))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return S(_e)}const c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));function ve(e,o=0){return c[e[o+0]]+c[e[o+1]]+c[e[o+2]]+c[e[o+3]]+"-"+c[e[o+4]]+c[e[o+5]]+"-"+c[e[o+6]]+c[e[o+7]]+"-"+c[e[o+8]]+c[e[o+9]]+"-"+c[e[o+10]]+c[e[o+11]]+c[e[o+12]]+c[e[o+13]]+c[e[o+14]]+c[e[o+15]]}const ge=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),R={randomUUID:ge};function he(e,o,s){if(R.randomUUID&&!o&&!e)return R.randomUUID();e=e||{};const a=e.random||(e.rng||fe)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,o){s=s||0;for(let l=0;l<16;++l)o[s+l]=a[l];return o}return ve(a)}const me=e=>(ie("data-v-db2027b4"),e=e(),re(),e),ye=me(()=>y("div",{class:"bg"},null,-1)),be={class:"main"},we={key:0,class:"short_answer"},xe={key:1,class:"paragraph"},ke={key:2,class:"prompt"},De={key:3,class:"multiple"},Ve={key:4,class:"checkboxes"},qe={key:5,class:"dropdown"},Ie={key:6,class:"date"},Ue={key:0,class:"text-deep-orange-darken-3",style:{"margin-top":"1rem"}},$e={class:"file",style:{"padding-top":"20px"}},Se={key:0,style:{"margin-bottom":"0.3rem"}},Ce={style:{display:"none"},id:"_info"},C=ae(),z={position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!1,draggablePercent:.6,showCloseButtonOnHover:!0,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1},ze={data(){return{ans:[],cardloading:[],surveyInfo:{},ans_temp:[],collected:!1}},methods:{async submit(){let e;const o=E().params.id[0],s=this.ans;localStorage.getItem("cransurvey-usrid")?e=localStorage.getItem("cransurvey-usrid"):(e=he(),localStorage.setItem("cransurvey-usrid",e));const a=[],l=JSON.parse(document.getElementById("_info").innerText);for(const r in l.questions){if(l.questions[r].required&&!s[r]&&s[r]!=0)return C.error(this.$t("view.required_question"),z),!1;if(l.questions[r].type=="date"&&(s[r]=new Date(s[r]).getTime(),l.questions[r].validate=l.questions[r].options.optionsData),l.questions[r].type=="file"&&(l.questions[r].validate=l.questions[r].options.optionsData),s[r]&&!T(s[r],l.questions[r].type,l.questions[r].validate))return C.error(this.$t("view.requirements_submit"),z),!1;a.push({id:r,answer:s[r]})}if(this.cardloading.includes(!0))return C.error(this.$t("view.wait_upload"),z),!1;if((await $fetch("/api/survey/collect",{method:"POST",body:{uniqueId:o,userId:e,answers:a}})).code==0)this.collected=!0;else return C.error(this.$t("view.went_wrong"),z),!1},checkboxesItem(e,o,s){const a=this.ans;if(!a[o]){a[o]=[];for(let g=0;g<=s-1;g++)a[o].push(!1)}let l=e.target.value;l=Number(l),a[o][l]==!0?a[o][l]=!1:a[o][l]=!0},async upload(e,o){const s=new FormData;s.append("file",e.target.files[0]),this.cardloading[o]=!0;const a=await $fetch("/api/upload/"+e.target.files[0].name,{method:"PUT",body:s});console.log(e.target.files[0]),this.ans[o]=a,this.cardloading[o]=!1}},async mounted(){}},Te=Object.assign(ze,{__name:"[...id]",async setup(e){let o,s;const l=E().params.id[0],g=([o,s]=P(()=>$fetch("/api/survey/get",{method:"POST",body:{uniqueId:l}})),o=await o,s(),o);for(const n of g.survey.questions)if(n.type=="dropdown")for(const b in n.options.optionsData)n.options.optionsData[b]={text:n.options.optionsData[b],value:Number(b)};const r=g.survey,N={images:["png","jpg","jpeg","gif","webp","svg","ico","bmp","tiff","tif"],docs:["docs","doc","docx","odt","rtf","tex","txt","wpd"],pdf:["pdf"],sheets:["sheets","xls","xlsx","ods","csv"],slides:["slides","ppt","pptx","odp"],audios:["mp3","wav","wma","m4a","aac","oga","flac","webma"],videos:["mp4","webm","mov","mkv","flv","ogv","avi","wmv","m4v"],archives:["zip","tar.gz","tar.xz","tar.lz","tar.bz2","tar"]},F=n=>{const b=[];for(const q in n)for(const I in N[n[q]])b.push("."+N[n[q]][I]);return b.toString()},A=([o,s]=P(()=>$fetch("/api/config/get",{method:"GET"})),o=await o,s(),o).data;return(n,b)=>{const q=ce,I=p("v-card-title"),D=p("v-card-text"),H=p("v-divider"),U=p("v-card"),L=p("v-card-subtitle"),G=p("v-text-field"),J=p("v-textarea"),M=p("v-radio"),K=p("v-radio-group"),Q=p("v-checkbox"),W=p("v-select"),O=p("v-btn"),X=p("v-date-picker"),Y=p("v-spacer"),Z=p("v-card-actions"),ee=p("v-dialog"),te=p("v-file-input");return _(),v($,null,[ye,y("div",be,[i(q,null,{default:u(()=>[w(f(h(r).title)+" - "+f(h(A).title||"CranSurvey"),1)]),_:1}),i(U,{style:{"box-shadow":"none",padding:"10px 6px 16px 6px"},color:"light-green-lighten-4"},{default:u(()=>[i(I,{style:{"font-size":"1.5rem"}},{default:u(()=>[w(f(h(r).title),1)]),_:1}),i(D,{style:{opacity:"0.7","padding-bottom":"0.5rem"}},{default:u(()=>[w(f(h(r).description),1)]),_:1}),i(D,{class:"subtitle-text"},{default:u(()=>[i(H)]),_:1}),i(D,{class:"text-deep-orange-darken-3 subtitle-text",style:{"padding-top":"0.5rem"}},{default:u(()=>[w(f(n.$t("view.required")),1)]),_:1})]),_:1}),(_(!0),v($,null,j(h(r).questions,t=>x((_(),B(U,{color:"light-green-lighten-4",style:{"margin-top":"10px","box-shadow":"none"},loading:n.cardloading[t.id]},{default:u(()=>[i(I,{class:"quesition_card_title",style:{"font-size":"1rem"}},{default:u(()=>[w(f(t.question),1),x(y("span",null,"*",512),[[k,t.required]])]),_:2},1024),x(i(L,{class:"question_card_subtitle"},{default:u(()=>[w(f(t.prompt),1)]),_:2},1536),[[k,t.type!="info"&&t.prompt]]),i(D,{class:"question_card_text"},{default:u(()=>[t.type=="short_answer"?(_(),v("div",we,[i(G,{variant:"outlined",label:n.$t("view.your_answer"),placeholder:t.placeholder,counter:"",rules:[d=>h(T)(d||"",t.type,t.validate)||n.$t("view.requirements")+" ("+t.validate.split(":")[0]+"-"+t.validate.split(":")[1]+")"],modelValue:n.ans[t.id],"onUpdate:modelValue":d=>n.ans[t.id]=d},null,8,["label","placeholder","rules","modelValue","onUpdate:modelValue"])])):m("",!0),t.type=="paragraph"?(_(),v("div",xe,[i(J,{label:n.$t("view.your_answer"),variant:"outlined",placeholder:t.placeholder,counter:"",rules:[d=>h(T)(d||"",t.type,t.validate)||n.$t("view.requirements")+" ("+t.validate.split(":")[0]+"-"+t.validate.split(":")[1]+")"],modelValue:n.ans[t.id],"onUpdate:modelValue":d=>n.ans[t.id]=d},null,8,["label","placeholder","rules","modelValue","onUpdate:modelValue"])])):m("",!0),t.type=="info"?(_(),v("div",ke,[y("p",null,f(t.prompt),1)])):m("",!0),t.type=="multiple"&&t.options&&t.options.optionsData?(_(),v("div",De,[i(K,{modelValue:n.ans[t.id],"onUpdate:modelValue":d=>n.ans[t.id]=d},{default:u(()=>[(_(!0),v($,null,j(t.options.optionsData,(d,V)=>(_(),B(M,{label:d,value:V},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):m("",!0),t.type=="checkboxes"&&t.options&&t.options.optionsData?(_(),v("div",Ve,[(_(!0),v($,null,j(t.options.optionsData,(d,V)=>(_(),B(Q,{class:"viewing-checkboxes",onChange:oe=>n.checkboxesItem(oe,t.id,t.options.optionsData.length),label:d,value:V},null,8,["onChange","label","value"]))),256))])):m("",!0),t.type=="dropdown"&&t.options&&t.options.optionsData?(_(),v("div",qe,[i(W,{items:t.options.optionsData,modelValue:n.ans[t.id],"onUpdate:modelValue":d=>n.ans[t.id]=d,"item-title":"text","item-value":"value",label:n.$t("view.select")},null,8,["items","modelValue","onUpdate:modelValue","label"])])):m("",!0),t.type=="date"&&t.options&&t.options.optionsData?(_(),v("div",Ie,[i(ee,{width:"500"},{activator:u(({props:d})=>[y("p",null,[i(O,le(d,{text:"Select Date",variant:"outlined"}),null,16),x(y("span",{style:{"margin-left":"1rem"}},f(new Date(n.ans[t.id]).toLocaleString()),513),[[k,n.ans[t.id]]])]),n.ans[t.id]&&!h(T)(new Date(n.ans[t.id]).getTime(),"date",t.options.optionsData)?(_(),v("p",Ue,f(n.$t("view.requirements")),1)):m("",!0)]),default:u(({isActive:d})=>[i(U,{title:"Date"},{default:u(()=>[i(D,null,{default:u(()=>[i(X,{modelValue:n.ans[t.id],"onUpdate:modelValue":V=>n.ans[t.id]=V,variant:"outlined",style:{margin:"0 auto","box-shadow":"none"},min:t.options.optionsData[0],max:t.options.optionsData[1]},null,8,["modelValue","onUpdate:modelValue","min","max"])]),_:2},1024),i(Z,null,{default:u(()=>[i(Y),i(O,{text:n.$t("results.close"),onClick:V=>d.value=!1},null,8,["text","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])):m("",!0),x(y("div",$e,[i(te,{label:n.$t("view.file"),variant:"outlined",accept:F(t.options.optionsData),onChange:d=>n.upload(d,t.id)},null,8,["label","accept","onChange"]),n.ans[t.id]?(_(),v("p",Se,f(n.$t("view.uploaded"))+" "+f(n.ans[t.id]),1)):m("",!0)],512),[[k,t.type=="file"&&t.options&&t.options.optionsData]])]),_:2},1024)]),_:2},1032,["loading"])),[[k,!n.collected]])),256)),x(i(U,{color:"light-green-lighten-4",style:{"margin-top":"10px","box-shadow":"none"}},{default:u(()=>[i(D,null,{default:u(()=>[y("p",null,f(n.$t("view.submited")),1)]),_:1})]),_:1},512),[[k,n.collected]]),x(i(O,{style:{"box-shadow":"none","background-color":"#dcedc8 !important",float:"right",color:"rgba(0, 0, 0, 0.8) !important","margin-top":"10px","text-align":"right","margin-bottom":"30px"},onClick:n.submit,disabled:!n.ans},{default:u(()=>[w(f(n.$t("view.submit")),1)]),_:1},8,["onClick","disabled"]),[[k,!n.collected]]),y("span",Ce,f(h(r)),1)])],64)}}}),Ne=de(Te,[["__scopeId","data-v-db2027b4"]]);export{Ne as default};
