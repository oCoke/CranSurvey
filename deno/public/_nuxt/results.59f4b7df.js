import{l as j,u as P,n as b,r as a,o as u,c as i,a as r,t as o,b as s,w as t,F as k,f as C,g as I,s as H,x as J,y as z,d as $,m as D,i as O,h as E}from"./entry.d0f737aa.js";/* empty css             */const G={class:"text-h4"},W={class:"mainGroup"},K={style:{"font-family":"monospace !important"},class:"text-subtitle-1"},M={key:0},X={class:"text-left"},Y={class:"text-left"},Z={class:"text-left"},x={class:"text-left"},ee={key:0},se={key:1,style:{"text-decoration":"underline"}},te={key:2},oe={key:0},ne={key:1},re={key:2},le=j(),ae={position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!1,draggablePercent:.6,showCloseButtonOnHover:!0,hideProgressBar:!0,closeButton:"button",icon:!0,rtl:!1},ue={data(){return{drawer:!0,rail:!0,surveyResp:{},surveyText:"",surveyTitle:"",surveyAnswers:[],surveyQuestions:[]}},methods:{signout(){sessionStorage.removeItem("_cransurvey_token"),sessionStorage.removeItem("_cransurvey_usr"),le.success(this.$t("users.signout_success"),ae),b(P()("/sign-in"))},desc(n){return typeof n!="string"||n.length<=100?n:(n=n.slice(0,100),n.endsWith(" ")?n.slice(0,99)+"...":n+"...")}},async mounted(){const n=await $fetch("/api/survey/result",{method:"POST",body:JSON.stringify({token:sessionStorage.getItem("_cransurvey_token"),uniqueId:E().query.id})});n.code==0?(this.surveyResp=n,this.surveyText=this.$t("results.survey_preview",{count:n.answers.length,id:n.survey.id,time:"`"+new Date(n.survey.created_at).toLocaleString()+"`",title:n.survey.title}),this.surveyAnswers=n.answers,this.surveyQuestions=n.survey.questions,this.surveyTitle=': "'+n.survey.title+'"'):(this.surveyResp={},this.surveyText=this.$t("results.no_results")),this.ongoingLoading=!1,this.username=sessionStorage.getItem("_cransurvey_usr")}},pe=Object.assign(ue,{__name:"results",setup(n){const w=P();{const e=sessionStorage.getItem("_cransurvey_token"),d=sessionStorage.getItem("_cransurvey_usr");!e||!d?b(w("/sign-in")):sessionStorage.getItem("_cransurvey_token_lock")||$fetch("/api/usr/token",{method:"POST",body:JSON.stringify({token:e})}).then(y=>{y.code==0?sessionStorage.setItem("_cransurvey_token_lock",!0):(sessionStorage.removeItem("_cransurvey_token"),sessionStorage.removeItem("_cransurvey_usr"),b(w("/sign-in")))})}return(e,d)=>{const y=a("v-col"),V=a("v-fade-transition"),B=a("v-row"),q=a("v-expansion-panel-title"),Q=a("v-card-text"),g=a("v-spacer"),_=a("v-btn"),f=a("v-card-actions"),m=a("v-card"),S=a("v-dialog"),L=a("v-checkbox"),N=a("v-table"),R=a("v-expansion-panel-text"),U=a("v-expansion-panel"),A=a("v-expansion-panels");return u(),i(k,null,[r("h1",G,o(e.$t("results.results"))+o(e.surveyTitle),1),r("div",W,[r("p",K,o(e.surveyText),1),s(m,{variant:"outlined",style:{margin:"20px auto",padding:"15px"}},{default:t(()=>[s(A,null,{default:t(()=>[(u(!0),i(k,null,C(e.surveyAnswers,v=>(u(),I(U,null,{default:t(()=>[s(q,null,{default:t(({expanded:c})=>[s(B,{"no-gutters":""},{default:t(()=>[s(y,{cols:"4",class:"d-flex justify-start"},{default:t(()=>[r("code",null,o(e.$t("results.from_user",{usr:v.usr.slice(-6)})),1)]),_:2},1024),s(y,{cols:"8",class:"text-grey"},{default:t(()=>[s(V,{"leave-absolute":""},{default:t(()=>[c?(u(),i("span",M," #"+o(v.id.slice(-6)),1)):H("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(R,null,{default:t(()=>[r("p",null,o(e.$t("results.collected_at",{date:new Date(v.created_at).toLocaleString()})),1),s(N,{style:{"margin-top":"1.5rem"}},{default:t(()=>[r("thead",null,[r("tr",null,[r("th",X,o(e.$t("results.question")),1),r("th",Y,o(e.$t("results.answer")),1),r("th",Z,o(e.$t("results.country_area")),1),r("th",x,o(e.$t("results.type")),1)])]),r("tbody",null,[(u(!0),i(k,null,C(v.ans,(c,l)=>(u(),i("tr",{key:c.name},[r("td",null,[s(S,{width:"500"},{activator:t(({props:p})=>[r("p",J(z(p)),o(e.surveyQuestions[l].question),17)]),default:t(({isActive:p})=>[s(m,{title:e.$t("results.results")},{default:t(()=>[s(Q,null,{default:t(()=>[$(o(e.surveyQuestions[l].question),1)]),_:2},1024),s(f,null,{default:t(()=>[s(g),s(_,{text:e.$t("results.close"),onClick:h=>p.value=!1},null,8,["text","onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024)]),r("td",null,[s(S,{width:"500"},{activator:t(({props:p})=>[r("p",D(p,{style:{cursor:"pointer"}}),[(e.surveyQuestions[l].type=="multiple"||e.surveyQuestions[l].type=="dropdown")&&e.surveyQuestions[l].options&&e.surveyQuestions[l].options.optionsData?(u(),i("span",ee,o(e.surveyQuestions[l].options.optionsData[c.answer]),1)):e.surveyQuestions[l].type=="checkboxes"?(u(),i("span",se,o(e.$t("results.details")),1)):(u(),i("span",te,o(e.desc(c.answer)),1))],16)]),default:t(({isActive:p})=>[s(m,{title:e.$t("results.results")},{default:t(()=>[s(Q,null,{default:t(()=>[(e.surveyQuestions[l].type=="multiple"||e.surveyQuestions[l].type=="dropdown")&&e.surveyQuestions[l].options&&e.surveyQuestions[l].options.optionsData?(u(),i("span",oe,o(e.surveyQuestions[l].options.optionsData[c.answer]),1)):e.surveyQuestions[l].type=="checkboxes"&&e.surveyQuestions[l].options&&e.surveyQuestions[l].options.optionsData?(u(),i("div",ne,[(u(!0),i(k,null,C(e.surveyQuestions[l].options.optionsData,(h,T)=>(u(),I(L,{"hide-details":"",disabled:"",class:"viewing-checkboxes",label:h,modelValue:c.answer[T],"onUpdate:modelValue":F=>c.answer[T]=F},null,8,["label","modelValue","onUpdate:modelValue"]))),256))])):(u(),i("span",re,o(c.answer),1))]),_:2},1024),s(f,null,{default:t(()=>[s(g),s(_,{text:e.$t("results.close"),onClick:h=>p.value=!1},null,8,["text","onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024)]),r("td",null,[s(S,{width:"500"},{activator:t(({props:p})=>[r("p",D(p,{style:{cursor:"pointer"}}),o(v.geoip[0]+", "+v.geoip[2]+", "+v.geoip[4]||"Unknown"),17)]),default:t(({isActive:p})=>[s(m,{title:e.$t("results.results")},{default:t(()=>[s(Q,null,{default:t(()=>[$(o(v.geoip[0]+", "+v.geoip[2]+", "+v.geoip[1]||"Unknown"),1)]),_:2},1024),s(f,null,{default:t(()=>[s(g),s(_,{text:e.$t("results.close"),onClick:h=>p.value=!1},null,8,["text","onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024)]),r("td",null,o(e.$t("new.types."+e.surveyQuestions[c.id].type)),1)]))),128))])]),_:2},1024),s(f,null,{default:t(()=>[s(g),s(_,{variant:"text",color:"primary",onClick:d[0]||(d[0]=c=>("navigateTo"in e?e.navigateTo:O(b))(O(w)("/dash/edit?id=")))},{default:t(()=>[$(o(e.$t("results.delete")),1)]),_:1})]),_:1})]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}),s(_,{variant:"outlined",onClick:e.signout},{default:t(()=>[$(o(e.$t("users.signout")),1)]),_:1},8,["onClick"])])],64)}}});export{pe as default};
